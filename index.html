<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ Ø±ÛŒØ§Ø¶ÛŒ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
* { box-sizing: border-box; }

body {
  font-family: "Vazirmatn", Tahoma, sans-serif;
  margin: 0;
  padding: 0;
  transition: background 0.4s ease, color 0.4s ease;
}

/* Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù† */
body.light {
  background: radial-gradient(circle at top, #fff7ed, #fffdf8 55%, #fff3e6);
  color: #222;
}

/* Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© (Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù†Ø§Ø±Ù†Ø¬ÛŒ-Ù…Ø­ÙˆØ±) */
body.dark {
  background: radial-gradient(circle at top, #0b0b0d, #0f0b0a 45%, #070405);
  color: #f3efe9;
}

/* Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ø±Ú© Ù…ÙˆØ¯ */
.toggle-btn {
  position: fixed;
  top: 16px;
  left: 16px;
  background: linear-gradient(90deg,#ff8a00,#ff6a00);
  color: #021;
  padding: 9px 14px;
  border-radius: 999px;
  cursor: pointer;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: background 0.3s ease, transform 0.2s ease;
  z-index: 1000;
}
.toggle-btn span.icon { font-size: 16px; }
.toggle-btn:hover {
  transform: translateY(-2px);
}

/* Ù¾Ù†Ù„ Ø§ØµÙ„ÛŒ */
.panel {
  max-width: 920px;
  margin: 80px auto 40px auto;
  background: rgba(255, 255, 255, 0.06);
  backdrop-filter: blur(14px);
  padding: 28px 26px 34px 26px;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(6, 6, 6, 0.6);
  animation: fadeIn 0.7s ease;
}

body.light .panel {
  background: rgba(255,255,255,0.9);
  box-shadow: 0 12px 36px rgba(15, 23, 42, 0.08);
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

h2 {
  text-align: center;
  font-size: 26px;
  margin-bottom: 6px;
}

.subtitle {
  text-align: center;
  font-size: 14px;
  opacity: 0.85;
  margin-bottom: 12px;
}

/* ØªÙˆØ¶ÛŒØ­ Ú©ÙˆØªØ§Ù‡ Ø§ÙˆÙ„ÛŒÙ‡ */
.info-box {
  max-width: 820px;
  margin: 8px auto 18px auto;
  background: linear-gradient(90deg, rgba(255,138,0,0.12), rgba(255,106,0,0.06));
  border: 1px solid rgba(255,138,0,0.18);
  color: inherit;
  padding: 10px 14px;
  border-radius: 12px;
  font-size: 14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}
.info-box .text { opacity:0.95; }
.info-box .close-btn {
  background: transparent;
  border: none;
  color: inherit;
  cursor: pointer;
  font-weight:700;
  padding:6px 8px;
  border-radius:8px;
}
.info-box .close-btn:hover { background: rgba(0,0,0,0.06); }

/* Ø´Ù…Ø§Ø± Ø¨Ø§Ø²Ø¯ÛŒØ¯ */
#views {
  text-align: center;
  font-size: 13px;
  opacity: 0.78;
  margin-bottom: 14px;
}

/* ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø¬Ø³ØªØ¬Ùˆ */
.controls {
  display:flex;
  gap:12px;
  justify-content:center;
  align-items:center;
  margin-bottom:16px;
  flex-wrap:wrap;
}
#search-box {
  width:360px;
  max-width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:none;
  font-size:14px;
  outline:none;
  background: rgba(255,255,255,0.04);
  color: inherit;
}
.filters {
  display:flex;
  gap:8px;
}
.filters button {
  padding:8px 12px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  background: rgba(255,255,255,0.04);
  color: inherit;
  font-size:13px;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}
.filters button.active {
  background: linear-gradient(90deg,#ff8a00,#ff6a00);
  color: #021;
  transform: translateY(-3px);
  box-shadow: 0 10px 30px rgba(255,106,0,0.12);
}

/* Ù„ÛŒØ³Øª ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ */
ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

li {
  background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
  margin: 12px 0;
  padding: 14px 16px;
  border-radius: 14px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  box-shadow: 0 8px 26px rgba(0,0,0,0.45);
  transition: transform 0.22s ease, box-shadow 0.22s ease, border-color 0.18s;
}

body.light li {
  background: linear-gradient(135deg, #fff, #fff);
  box-shadow: 0 6px 18px rgba(15,23,42,0.06);
}

li:hover {
  transform: translateY(-4px);
  box-shadow: 0 14px 36px rgba(0,0,0,0.28);
}

.file-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
}

.file-title {
  font-size: 15px;
  font-weight: 700;
  display:flex;
  align-items:center;
  gap:8px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.file-meta {
  font-size: 12px;
  opacity: 0.82;
}

/* Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ */
.badge {
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 11px;
  margin-left: 8px;
}
.badge.new { background: linear-gradient(90deg,#ff6a00,#ff8a00); color: #021; font-weight:700; }
.badge.notdl { background: #ffd9b8; color: #5a2b00; font-weight:700; }

/* Ø­Ø§Ù„Øªâ€ŒÙ‡Ø§ */
.not-downloaded { border: 2px solid rgba(255,138,0,0.18); }
.downloaded { opacity: 0.78; transform: scale(0.998); }

/* Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯ */
.download-btn {
  text-decoration: none;
  color: #021;
  background: linear-gradient(90deg,#ffb86b,#ff8a00);
  padding: 8px 16px;
  border-radius: 999px;
  font-size: 13px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: transform 0.18s ease, box-shadow 0.18s ease;
  box-shadow: 0 8px 26px rgba(255,106,0,0.12);
}
.download-btn:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 12px 36px rgba(255,106,0,0.18);
}

/* Ù†Ø³Ø®Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
@media (max-width: 600px) {
  .panel {
    margin: 20px 12px 30px 12px;
    padding: 18px 14px 22px 14px;
  }

  li {
    flex-direction: column;
    align-items: flex-start;
    padding: 12px;
    gap: 10px;
  }

  .download-btn {
    width: 100%;
    justify-content: center;
    padding: 10px 0;
    font-size: 14px;
    border-radius: 12px;
  }

  .controls { flex-direction: column; gap:10px; align-items:stretch; }
  #search-box { width:100%; }
}
</style>
</head>
<body class="dark">

<!-- Ø¯Ú©Ù…Ù‡ ØªÙ… -->
<div class="toggle-btn" onclick="toggleTheme()">
  <span class="icon">ğŸŒ™</span>
  <div id="theme-label">Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©</div>
</div>

<div class="panel">
  <h2>ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ Ø±ÛŒØ§Ø¶ÛŒ</h2>
  <div class="subtitle">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¬Ø²ÙˆÙ‡â€ŒÙ‡Ø§ØŒ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ Ùˆ Ù†Ù…ÙˆÙ†Ù‡ Ø³ÙˆØ§Ù„â€ŒÙ‡Ø§</div>

  <!-- ØªÙˆØ¶ÛŒØ­ Ú©ÙˆØªØ§Ù‡ Ø§ÙˆÙ„ÛŒÙ‡ -->
  <div id="intro" class="info-box" role="note">
    <div class="text">Ø§Ø² Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¯Ø±Ø³ Ø±ÛŒØ§Ø¶ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯ â€” Ø¢Ø±Ø´Ø§Ù… ÙØ§Ø¶Ù„</div>
    <button class="close-btn" onclick="dismissIntro()">Ø¨Ø³ØªÙ†</button>
  </div>

  <div id="views">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>

  <div class="controls">
    <input id="search-box" type="text" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§...">
    <div class="filters" role="toolbar" aria-label="ÙÛŒÙ„ØªØ± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§">
      <button data-filter="all" class="active">Ù‡Ù…Ù‡</button>
      <button data-filter="new">Ø¬Ø¯ÛŒØ¯Ù‡Ø§</button>
      <button data-filter="not-downloaded">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡</button>
      <button data-filter="downloaded">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯Ù‡</button>
    </div>
  </div>

  <ul id="file-list" aria-live="polite"></ul>

  <div class="footer" style="text-align:center;margin-top:25px;font-size:13px;opacity:0.9;">
    Â© 2026 â€” ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª | Ø¢Ø±Ø´Ø§Ù… ÙØ§Ø¶Ù„
  </div>
</div>

<script>
// ------------------ Ø¯Ø§Ø±Ú©/Ù„Ø§ÛŒØª Ù…ÙˆØ¯ Ø¨Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage ------------------
function applyTheme(theme) {
  document.body.classList.remove("light", "dark");
  document.body.classList.add(theme);
  const label = document.getElementById("theme-label");
  const iconSpan = document.querySelector(".toggle-btn .icon");
  if (theme === "dark") {
    label.textContent = "Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©";
    iconSpan.textContent = "ğŸŒ™";
  } else {
    label.textContent = "Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†";
    iconSpan.textContent = "â˜€ï¸";
  }
}

function toggleTheme() {
  const current = document.body.classList.contains("dark") ? "dark" : "light";
  const next = current === "dark" ? "light" : "dark";
  applyTheme(next);
  localStorage.setItem("theme", next);
}

(function initTheme() {
  const saved = localStorage.getItem("theme");
  if (saved) applyTheme(saved);
  else applyTheme("dark");
})();

// ------------------ Ù†Ù…Ø§ÛŒØ´/Ø¨Ø³ØªÙ† ØªÙˆØ¶ÛŒØ­ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ø°Ø®ÛŒØ±Ù‡ ÙˆØ¶Ø¹ÛŒØª ------------------
function dismissIntro() {
  const el = document.getElementById('intro');
  el.style.display = 'none';
  localStorage.setItem('introDismissed', '1');
}
(function initIntro() {
  if (localStorage.getItem('introDismissed') === '1') {
    const el = document.getElementById('intro');
    if (el) el.style.display = 'none';
  }
})();

// ------------------ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ø¨Ø§Ø²Ø¯ÛŒØ¯ ÙˆØ§Ù‚Ø¹ÛŒ ------------------
(function visitCounter() {
  let views = localStorage.getItem("myViews");
  views = views ? Number(views) + 1 : 1;
  localStorage.setItem("myViews", views);
  document.getElementById("views").textContent = "ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø´Ù…Ø§: " + views;
})();

// ------------------ ØªØ´Ø®ÛŒØµ Ø¢ÛŒÚ©ÙˆÙ† ------------------
function getFileIcon(name) {
  const ext = name.split(".").pop().toLowerCase();
  const icons = {
    pdf: "ğŸ“•", zip: "ğŸ—‚ï¸", rar: "ğŸ—‚ï¸",
    jpg: "ğŸ–¼ï¸", jpeg: "ğŸ–¼ï¸", png: "ğŸ–¼ï¸", gif: "ğŸ–¼ï¸",
    mp4: "ğŸ¬", mov: "ğŸ¬", avi: "ğŸ¬",
    mp3: "ğŸµ", wav: "ğŸµ",
    doc: "ğŸ“„", docx: "ğŸ“„",
    ppt: "ğŸ“Š", pptx: "ğŸ“Š",
    txt: "ğŸ“˜", json: "ğŸ§©", html: "ğŸŒ"
  };
  return icons[ext] || "ğŸ“";
}

// ------------------ localStorage helpers Ø¨Ø±Ø§ÛŒ NEW Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯Ù‡Ø§ ------------------
function saveFileList(files) {
  localStorage.setItem("fileList", JSON.stringify(files.map(f => f.name)));
}

function markNewFiles(files) {
  const oldList = JSON.parse(localStorage.getItem("fileList") || "[]");
  files.forEach(f => f.isNew = !oldList.includes(f.name));
}

function isDownloaded(name) {
  const list = JSON.parse(localStorage.getItem("downloadedFiles") || "[]");
  return list.includes(name);
}

function markDownloaded(name) {
  const list = JSON.parse(localStorage.getItem("downloadedFiles") || "[]");
  if (!list.includes(name)) {
    list.push(name);
    localStorage.setItem("downloadedFiles", JSON.stringify(list));
  }
}

// ------------------ Ú¯Ø±ÙØªÙ† ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø§Ø² GitHub ------------------
async function loadFiles() {
  const url = "https://api.github.com/repos/fordriveaf-hue/files-class/contents/files";
  try {
    const res = await fetch(url);
    const data = await res.json();

    const files = data
      .filter(item => item.type === "file")
      .map(item => ({
        name: item.name,
        size: (item.size / 1024).toFixed(1) + "KB",
        url: item.download_url,
        icon: getFileIcon(item.name)
      }));

    markNewFiles(files);
    renderFiles(files);
    saveFileList(files);
  } catch (err) {
    console.error(err);
    document.getElementById("views").textContent = "Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§.";
  }
}

// ------------------ Ø±Ù†Ø¯Ø± ------------------
function renderFiles(list) {
  const ul = document.getElementById("file-list");
  ul.innerHTML = "";

  list.forEach(file => {
    const li = document.createElement("li");

    const downloaded = isDownloaded(file.name);
    const newBadge = file.isNew ? `<span class="badge new">NEW</span>` : "";
    const dlBadge = !downloaded ? `<span class="badge notdl">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù‡</span>` : "";

    li.className = "";
    if (file.isNew) li.classList.add("is-new");
    li.classList.add(downloaded ? "downloaded" : "not-downloaded");

    li.innerHTML = `
      <div class="file-info">
        <div class="file-title">${newBadge}${dlBadge}<span class="file-icon">${file.icon}</span><span style="max-width:520px;display:inline-block;vertical-align:middle;overflow:hidden;text-overflow:ellipsis;">${file.name}</span></div>
        <div class="file-meta">Ø­Ø¬Ù…: ${file.size}</div>
      </div>
      <a class="download-btn" href="${file.url}" target="_blank" data-name="${file.name}">
        <span>â¬‡ï¸</span> Ø¯Ø§Ù†Ù„ÙˆØ¯
      </a>
    `;

    ul.appendChild(li);
  });

  // Ø«Ø¨Øª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ©
  document.querySelectorAll(".download-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      markDownloaded(btn.dataset.name);
      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡
      setTimeout(() => {
        // Ø¨Ø§Ø²Ø®ÙˆØ§Ù†ÛŒ Ù„ÛŒØ³Øª ÙØ¹Ù„ÛŒ Ø§Ø² DOM Ùˆ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§/Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§
        document.querySelectorAll("#file-list li").forEach(li => {
          const name = li.querySelector(".download-btn")?.dataset.name;
          if (name) {
            if (isDownloaded(name)) {
              li.classList.remove("not-downloaded");
              li.classList.add("downloaded");
              const badge = li.querySelector(".badge.notdl");
              if (badge) badge.remove();
            }
          }
        });
      }, 120);
    });
  });
}

// ------------------ ÙÛŒÙ„ØªØ± ------------------
function applyFilter(type) {
  const items = document.querySelectorAll("#file-list li");

  items.forEach(li => {
    li.style.display = "flex";

    if (type === "new" && !li.classList.contains("is-new")) li.style.display = "none";
    if (type === "not-downloaded" && !li.classList.contains("not-downloaded")) li.style.display = "none";
    if (type === "downloaded" && !li.classList.contains("downloaded")) li.style.display = "none";
  });
}

document.addEventListener("click", e => {
  if (e.target.matches(".filters button")) {
    document.querySelectorAll(".filters button").forEach(btn => btn.classList.remove("active"));
    e.target.classList.add("active");
    applyFilter(e.target.dataset.filter);
  }
});

// ------------------ Ø¬Ø³ØªØ¬Ùˆ Ø²Ù†Ø¯Ù‡ ------------------
document.getElementById("search-box").addEventListener("input", function () {
  const text = this.value.trim().toLowerCase();
  const items = document.querySelectorAll("#file-list li");

  items.forEach(li => {
    const name = li.querySelector(".file-title").textContent.toLowerCase();
    li.style.display = name.includes(text) ? "flex" : "none";
  });
});

// ------------------ Ø´Ø±ÙˆØ¹ ------------------
loadFiles();
</script>

</body>
</html>
